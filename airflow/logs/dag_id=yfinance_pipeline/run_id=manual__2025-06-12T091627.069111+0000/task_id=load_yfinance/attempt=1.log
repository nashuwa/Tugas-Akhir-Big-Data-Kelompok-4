[2025-06-12T09:42:36.270+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: yfinance_pipeline.load_yfinance manual__2025-06-12T09:16:27.069111+00:00 [queued]>
[2025-06-12T09:42:36.290+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: yfinance_pipeline.load_yfinance manual__2025-06-12T09:16:27.069111+00:00 [queued]>
[2025-06-12T09:42:36.291+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 2
[2025-06-12T09:42:36.328+0000] {taskinstance.py:1327} INFO - Executing <Task(DockerOperator): load_yfinance> on 2025-06-12 09:16:27.069111+00:00
[2025-06-12T09:42:36.342+0000] {standard_task_runner.py:57} INFO - Started process 587 to run task
[2025-06-12T09:42:36.350+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'yfinance_pipeline', 'load_yfinance', 'manual__2025-06-12T09:16:27.069111+00:00', '--job-id', '30', '--raw', '--subdir', 'DAGS_FOLDER/yfinance_pipeline_dag.py', '--cfg-path', '/tmp/tmphnjjunsz']
[2025-06-12T09:42:36.351+0000] {standard_task_runner.py:85} INFO - Job 30: Subtask load_yfinance
[2025-06-12T09:42:36.462+0000] {task_command.py:410} INFO - Running <TaskInstance: yfinance_pipeline.load_yfinance manual__2025-06-12T09:16:27.069111+00:00 [running]> on host c8950c9ffc98
[2025-06-12T09:42:36.661+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='yfinance_pipeline' AIRFLOW_CTX_TASK_ID='load_yfinance' AIRFLOW_CTX_EXECUTION_DATE='2025-06-12T09:16:27.069111+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-12T09:16:27.069111+00:00'
[2025-06-12T09:42:36.786+0000] {docker.py:334} INFO - Starting docker container from image yfinance-load:latest
[2025-06-12T09:42:38.286+0000] {docker.py:403} INFO - 2025-06-12 09:42:38,283 - __main__ - INFO - ======================================================================
2025-06-12 09:42:38,284 - __main__ - INFO - 🚀 YFINANCE AUTO-LOAD TO 7 COLLECTIONS WITH DIFFERENT PERIODS
2025-06-12 09:42:38,284 - __main__ - INFO - ======================================================================
[2025-06-12T09:42:38.287+0000] {docker.py:403} INFO - 2025-06-12 09:42:38,284 - __main__ - INFO - Start time: 2025-06-12 09:42:38
[2025-06-12T09:42:38.288+0000] {docker.py:403} INFO - 2025-06-12 09:42:38,284 - __main__ - INFO - Loading from: /app/output/tickers_data.json
[2025-06-12T09:42:38.289+0000] {docker.py:403} INFO - 2025-06-12 09:42:38,284 - __main__ - INFO - Target database: bigdata_saham
[2025-06-12T09:42:38.291+0000] {docker.py:403} INFO - 2025-06-12 09:42:38,285 - __main__ - INFO - Target collections: ['data_harian', 'data_mingguan', 'data_bulanan', 'data_tahunan', 'data_lima_tahun', 'data_satu_tahun', 'data_tiga_tahun']
[2025-06-12T09:42:54.198+0000] {docker.py:403} INFO - 2025-06-12 09:42:54,189 - __main__ - INFO - 📁 Loaded 950 stock records from file
[2025-06-12T09:42:56.980+0000] {docker.py:403} INFO - 2025-06-12 09:42:56,976 - __main__ - INFO - 🔄 Reduced to 100 stocks for testing (avoiding quota limit)
[2025-06-12T09:42:57.893+0000] {docker.py:403} INFO - 2025-06-12 09:42:57,891 - __main__ - INFO - 🔗 MongoDB connection successful
2025-06-12 09:42:57,891 - __main__ - INFO - 
🔄 Processing data_harian with daily aggregation...
2025-06-12 09:42:57,891 - __main__ - INFO - 🔄 Limited to 70 stocks for data_harian (largest collection)
2025-06-12 09:42:57,891 - __main__ - INFO - 🔄 Transforming data for data_harian (daily periods)
[2025-06-12T09:43:00.226+0000] {docker.py:403} INFO - 2025-06-12 09:43:00,224 - __main__ - INFO - ✅ Created 83,930 documents for data_harian
[2025-06-12T09:43:00.227+0000] {docker.py:403} INFO - 2025-06-12 09:43:00,224 - __main__ - INFO - 📊 Loading data to bigdata_saham.data_harian
[2025-06-12T09:43:02.324+0000] {docker.py:403} INFO - 2025-06-12 09:43:02,321 - __main__ - INFO -   Batch 1/84: 1000 docs inserted
[2025-06-12T09:43:23.900+0000] {docker.py:403} INFO - 2025-06-12 09:43:23,897 - __main__ - INFO -   Batch 11/84: 1000 docs inserted
[2025-06-12T09:43:47.349+0000] {docker.py:403} INFO - 2025-06-12 09:43:47,347 - __main__ - INFO -   Batch 21/84: 1000 docs inserted
[2025-06-12T09:44:12.851+0000] {docker.py:403} INFO - 2025-06-12 09:44:12,848 - __main__ - INFO -   Batch 31/84: 1000 docs inserted
[2025-06-12T09:44:39.277+0000] {docker.py:403} INFO - 2025-06-12 09:44:39,275 - __main__ - INFO -   Batch 41/84: 1000 docs inserted
[2025-06-12T09:44:58.083+0000] {docker.py:403} INFO - 2025-06-12 09:44:58,082 - __main__ - INFO -   Batch 51/84: 1000 docs inserted
[2025-06-12T09:45:20.540+0000] {docker.py:403} INFO - 2025-06-12 09:45:20,538 - __main__ - INFO -   Batch 61/84: 1000 docs inserted
[2025-06-12T09:45:41.425+0000] {docker.py:403} INFO - 2025-06-12 09:45:41,423 - __main__ - INFO -   Batch 71/84: 1000 docs inserted
[2025-06-12T09:46:05.858+0000] {docker.py:403} INFO - 2025-06-12 09:46:05,855 - __main__ - INFO -   Batch 81/84: 1000 docs inserted
[2025-06-12T09:46:16.219+0000] {docker.py:403} INFO - 2025-06-12 09:46:16,217 - __main__ - INFO -   Batch 84/84: 930 docs inserted
2025-06-12 09:46:16,217 - __main__ - INFO - ✅ data_harian: 83,930 documents inserted
[2025-06-12T09:46:16.220+0000] {docker.py:403} INFO - 2025-06-12 09:46:16,217 - __main__ - INFO - 
🔄 Processing data_mingguan with weekly aggregation...
[2025-06-12T09:46:16.221+0000] {docker.py:403} INFO - 2025-06-12 09:46:16,218 - __main__ - INFO - 🔄 Limited to 100 stocks for data_mingguan
[2025-06-12T09:46:16.222+0000] {docker.py:403} INFO - 2025-06-12 09:46:16,218 - __main__ - INFO - 🔄 Transforming data for data_mingguan (weekly periods)
[2025-06-12T09:46:20.015+0000] {docker.py:403} INFO - 2025-06-12 09:46:20,013 - __main__ - INFO - ✅ Created 25,800 documents for data_mingguan
[2025-06-12T09:46:20.084+0000] {docker.py:403} INFO - 2025-06-12 09:46:20,081 - __main__ - INFO - 📊 Loading data to bigdata_saham.data_mingguan
[2025-06-12T09:46:23.230+0000] {docker.py:403} INFO - 2025-06-12 09:46:23,226 - __main__ - INFO -   Batch 1/26: 1000 docs inserted
[2025-06-12T09:46:40.972+0000] {docker.py:403} INFO - 2025-06-12 09:46:40,970 - __main__ - INFO -   Batch 11/26: 1000 docs inserted
[2025-06-12T09:47:08.262+0000] {docker.py:403} INFO - 2025-06-12 09:47:08,260 - __main__ - INFO -   Batch 21/26: 1000 docs inserted
[2025-06-12T09:47:24.220+0000] {docker.py:403} INFO - 2025-06-12 09:47:24,217 - __main__ - INFO -   Batch 26/26: 800 docs inserted
2025-06-12 09:47:24,218 - __main__ - INFO - ✅ data_mingguan: 25,800 documents inserted
[2025-06-12T09:47:24.221+0000] {docker.py:403} INFO - 2025-06-12 09:47:24,218 - __main__ - INFO - 
🔄 Processing data_bulanan with monthly aggregation...
[2025-06-12T09:47:24.222+0000] {docker.py:403} INFO - 2025-06-12 09:47:24,218 - __main__ - INFO - 🔄 Using all 100 stocks for data_bulanan
2025-06-12 09:47:24,218 - __main__ - INFO - 🔄 Transforming data for data_bulanan (monthly periods)
[2025-06-12T09:47:26.829+0000] {docker.py:403} INFO - 2025-06-12 09:47:26,826 - __main__ - INFO - ✅ Created 6,100 documents for data_bulanan
[2025-06-12T09:47:26.861+0000] {docker.py:403} INFO - 2025-06-12 09:47:26,859 - __main__ - INFO - 📊 Loading data to bigdata_saham.data_bulanan
[2025-06-12T09:47:29.632+0000] {docker.py:403} INFO - 2025-06-12 09:47:29,630 - __main__ - INFO -   Batch 1/7: 1000 docs inserted
[2025-06-12T09:47:38.102+0000] {docker.py:403} INFO - 2025-06-12 09:47:38,100 - __main__ - INFO -   Batch 7/7: 100 docs inserted
2025-06-12 09:47:38,100 - __main__ - INFO - ✅ data_bulanan: 6,100 documents inserted
2025-06-12 09:47:38,100 - __main__ - INFO - 
🔄 Processing data_tahunan with yearly aggregation...
2025-06-12 09:47:38,101 - __main__ - INFO - 🔄 Using all 100 stocks for data_tahunan
[2025-06-12T09:47:38.104+0000] {docker.py:403} INFO - 2025-06-12 09:47:38,101 - __main__ - INFO - 🔄 Transforming data for data_tahunan (yearly periods)
[2025-06-12T09:47:40.881+0000] {docker.py:403} INFO - 2025-06-12 09:47:40,879 - __main__ - INFO - ✅ Created 600 documents for data_tahunan
[2025-06-12T09:47:40.887+0000] {docker.py:403} INFO - 2025-06-12 09:47:40,886 - __main__ - INFO - 📊 Loading data to bigdata_saham.data_tahunan
[2025-06-12T09:47:44.784+0000] {docker.py:403} INFO - 2025-06-12 09:47:44,782 - __main__ - INFO -   Batch 1/1: 600 docs inserted
2025-06-12 09:47:44,782 - __main__ - INFO - ✅ data_tahunan: 600 documents inserted
2025-06-12 09:47:44,782 - __main__ - INFO - 
🔄 Processing data_lima_tahun with 5years aggregation...
[2025-06-12T09:47:44.785+0000] {docker.py:403} INFO - 2025-06-12 09:47:44,782 - __main__ - INFO - 🔄 Using all 100 stocks for data_lima_tahun
2025-06-12 09:47:44,782 - __main__ - INFO - 🔄 Transforming data for data_lima_tahun (5years periods)
[2025-06-12T09:47:47.453+0000] {docker.py:403} INFO - 2025-06-12 09:47:47,449 - __main__ - INFO - ✅ Created 6,100 documents for data_lima_tahun
[2025-06-12T09:47:47.456+0000] {docker.py:403} INFO - 2025-06-12 09:47:47,450 - __main__ - INFO - 📊 Loading data to bigdata_saham.data_lima_tahun
[2025-06-12T09:47:50.437+0000] {docker.py:403} INFO - 2025-06-12 09:47:50,435 - __main__ - INFO -   Batch 1/7: 1000 docs inserted
[2025-06-12T09:48:02.502+0000] {docker.py:403} INFO - 2025-06-12 09:48:02,500 - __main__ - INFO -   Batch 7/7: 100 docs inserted
2025-06-12 09:48:02,500 - __main__ - INFO - ✅ data_lima_tahun: 6,100 documents inserted
2025-06-12 09:48:02,500 - __main__ - INFO - 
🔄 Processing data_satu_tahun with 1year aggregation...
[2025-06-12T09:48:02.503+0000] {docker.py:403} INFO - 2025-06-12 09:48:02,500 - __main__ - INFO - 🔄 Using all 100 stocks for data_satu_tahun
[2025-06-12T09:48:02.504+0000] {docker.py:403} INFO - 2025-06-12 09:48:02,500 - __main__ - INFO - 🔄 Transforming data for data_satu_tahun (1year periods)
[2025-06-12T09:48:05.146+0000] {docker.py:403} INFO - 2025-06-12 09:48:05,143 - __main__ - INFO - ✅ Created 6,100 documents for data_satu_tahun
[2025-06-12T09:48:05.151+0000] {docker.py:403} INFO - 2025-06-12 09:48:05,149 - __main__ - INFO - 📊 Loading data to bigdata_saham.data_satu_tahun
[2025-06-12T09:48:08.108+0000] {docker.py:403} INFO - 2025-06-12 09:48:08,107 - __main__ - INFO -   Batch 1/7: 1000 docs inserted
[2025-06-12T09:48:25.059+0000] {docker.py:403} INFO - 2025-06-12 09:48:25,056 - __main__ - INFO -   Batch 7/7: 100 docs inserted
[2025-06-12T09:48:25.060+0000] {docker.py:403} INFO - 2025-06-12 09:48:25,057 - __main__ - INFO - ✅ data_satu_tahun: 6,100 documents inserted
[2025-06-12T09:48:25.060+0000] {docker.py:403} INFO - 2025-06-12 09:48:25,057 - __main__ - INFO - 
🔄 Processing data_tiga_tahun with 3years aggregation...
2025-06-12 09:48:25,057 - __main__ - INFO - 🔄 Using all 100 stocks for data_tiga_tahun
[2025-06-12T09:48:25.061+0000] {docker.py:403} INFO - 2025-06-12 09:48:25,057 - __main__ - INFO - 🔄 Transforming data for data_tiga_tahun (3years periods)
[2025-06-12T09:48:27.693+0000] {docker.py:403} INFO - 2025-06-12 09:48:27,690 - __main__ - INFO - ✅ Created 6,100 documents for data_tiga_tahun
[2025-06-12T09:48:27.700+0000] {docker.py:403} INFO - 2025-06-12 09:48:27,698 - __main__ - INFO - 📊 Loading data to bigdata_saham.data_tiga_tahun
[2025-06-12T09:48:30.937+0000] {docker.py:403} INFO - 2025-06-12 09:48:30,935 - __main__ - INFO -   Batch 1/7: 1000 docs inserted
[2025-06-12T09:48:44.025+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,022 - __main__ - INFO -   Batch 7/7: 100 docs inserted
2025-06-12 09:48:44,022 - __main__ - INFO - ✅ data_tiga_tahun: 6,100 documents inserted
[2025-06-12T09:48:44.026+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,023 - __main__ - INFO - 
======================================================================
[2025-06-12T09:48:44.027+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,023 - __main__ - INFO - 📊 FINAL SUMMARY
[2025-06-12T09:48:44.028+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,023 - __main__ - INFO - ======================================================================
[2025-06-12T09:48:44.028+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,023 - __main__ - INFO - Database: bigdata_saham
2025-06-12 09:48:44,023 - __main__ - INFO - Total collections processed: 7
2025-06-12 09:48:44,023 - __main__ - INFO - Successful collections: 7
[2025-06-12T09:48:44.029+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,023 - __main__ - INFO - Total documents inserted: 134,730
[2025-06-12T09:48:44.030+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,024 - __main__ - INFO - Execution time: 365.74 seconds
[2025-06-12T09:48:44.031+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,024 - __main__ - INFO - 🎉 ALL 7 COLLECTIONS CREATED SUCCESSFULLY!
[2025-06-12T09:48:44.050+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,048 - __main__ - INFO - 🔌 MongoDB connection closed
[2025-06-12T09:48:44.095+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,093 - __main__ - INFO - 🗑️ Deleted input file: /app/output/tickers_data.json
[2025-06-12T09:48:44.163+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,160 - __main__ - INFO - 
🏁 Final Status: success
2025-06-12 09:48:44,161 - __main__ - INFO - 📈 Created 7/7 collections
2025-06-12 09:48:44,161 - __main__ - INFO - 📊 Total documents: 134,730
[2025-06-12T09:48:44.164+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,161 - __main__ - INFO - 
📋 Collections created in database 'bigdata_saham':
[2025-06-12T09:48:44.165+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,161 - __main__ - INFO -   ✅ bigdata_saham.data_harian (daily aggregation)
[2025-06-12T09:48:44.166+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,161 - __main__ - INFO -   ✅ bigdata_saham.data_mingguan (weekly aggregation)
2025-06-12 09:48:44,161 - __main__ - INFO -   ✅ bigdata_saham.data_bulanan (monthly aggregation)
[2025-06-12T09:48:44.166+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,161 - __main__ - INFO -   ✅ bigdata_saham.data_tahunan (yearly aggregation)
2025-06-12 09:48:44,161 - __main__ - INFO -   ✅ bigdata_saham.data_lima_tahun (5years aggregation)
[2025-06-12T09:48:44.167+0000] {docker.py:403} INFO - 2025-06-12 09:48:44,161 - __main__ - INFO -   ✅ bigdata_saham.data_satu_tahun (1year aggregation)
2025-06-12 09:48:44,162 - __main__ - INFO -   ✅ bigdata_saham.data_tiga_tahun (3years aggregation)
[2025-06-12T09:48:46.130+0000] {taskinstance.py:1350} INFO - Marking task as SUCCESS. dag_id=yfinance_pipeline, task_id=load_yfinance, execution_date=20250612T091627, start_date=20250612T094236, end_date=20250612T094846
[2025-06-12T09:48:47.389+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 0
[2025-06-12T09:48:47.478+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check
