{% extends 'index.html' %}

{% block content %}
<main class="flex-1 p-8 overflow-auto">
  <div>
    <h2 class="text-2xl font-semibold text-gray-800 mb-4">IQ Plus Market News</h2>

    <!-- Tempat menampilkan daftar berita -->
    <div id="news-container" class="space-y-4"></div>
  </div>
</main>

<script>
  function toggleContent(id) {
    const el = document.getElementById(id);
    el.classList.toggle('hidden');
  }

  // Ambil data dari API
  fetch('/api/market_news')
    .then(res => res.json())
    .then(data => {
      const container = document.getElementById('news-container');

      data.forEach((b, index) => {
        const beritaHTML = `
          <div 
            class="bg-white p-4 rounded shadow cursor-pointer hover:bg-gray-100 transition"
            onclick="toggleContent('konten-${index}')"
          >
            <h3 class="text-xl font-semibold">${b.judul}</h3>
            <p class="text-gray-600 text-sm mb-2">
              ${b.tanggal_artikel} | 
              <a href="${b.link}" class="text-blue-500 underline" target="_blank">Lihat sumber</a>
            </p>
            <p class="text-gray-700">${b.ringkasan}</p>

            <!-- Isi lengkap disembunyikan -->
            <div id="konten-${index}" class="mt-3 hidden">
              <hr class="my-2">
              <p class="text-gray-800 whitespace-pre-line">${b.isi.replace(/\n/g, "<br>")}</p>
            </div>
          </div>
        `;

        container.innerHTML += beritaHTML;
      });
    })
    .catch(err => {
      console.error("Gagal mengambil berita:", err);
      document.getElementById('news-container').innerHTML = `<p class="text-red-500">Gagal memuat berita.</p>`;
    });
</script>
{% endblock %}